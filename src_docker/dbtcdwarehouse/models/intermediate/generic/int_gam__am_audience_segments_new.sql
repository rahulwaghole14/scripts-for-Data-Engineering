{{
  config(
    materialized = 'table',
    tags=['gam']
    )
}}

WITH account_management__user_profiles AS (

    SELECT ppid AS PPID
        , GROUPM_BLUECHIP
        , GROUPM_SMARTMONEY
        , GROUPM_FINANCIALFREEDOM
        , GROUPM_SELFMADLIFESTYLERS
        , GROUPM_WORLDLYANDWISE
        , GROUPM_STATUSMATTERS
        , GROUPM_SAVVYSELFSTARTERS
        , GROUPM_HUMANITARIANS
        , GROUPM_FULLHOUSE
        , GROUPM_YOUNGANDPLATINUM
        , GROUPM_HEALTHYWEALTHYANDWISE
        , GROUPM_CULTURALPIONEERS
        , GROUPM_NEWSCHOOLCOOL
        , GROUPM_URBANENTERTAINERS
        , GROUPM_NEWKIWIS
        , GROUPM_SOCIALACADEMICS
        , GROUPM_BIGFUTURE
        , GROUPM_FITANDFAB
        , GROUPM_QUIETACHIEVER
        , GROUPM_CAREERZONE
        , GROUPM_ONTHEIRWAY
        , GROUPM_GETTINGAHEAD
        , GROUPM_DOMESTICJUGGLERS
        , GROUPM_AVERAGEKIWI
        , GROUPM_DOWNTHEARTH
        , GROUPM_DOMESTICBLISS
        , GROUPM_DONEGOOD
        , GROUPM_TRADITIONALVALUES
        , GROUPM_CASTLEANDKIDS
        , GROUPM_HOUSEPROUD
        , GROUPM_FAMILYFIRST
        , GROUPM_RELAXEDLIVING
        , GROUPM_CAUTIOUSCONSERVATIVES
        , GROUPM_MAKINGTHERENT
        , GROUPM_MAKINGENDSMEET
        , GROUPM_DOINGITTOUGH
        , GROUPM_LIFESTRIVERS
        , GROUPM_ACTIVESOCIAL
        , GROUPM_HOMEENTERTAINMENT
        , GROUPM_BETTERDAYS
        , GROUPM_FAITHANDFAMILY
        , GROUPM_SIMPLELIVING
        , GROUPM_QUIETHOMELIFE
        , GROUPM_AREASINTRANSITION
        , GROUPM_STILLWORKING
        , GROUPM_NEWBEGINNINGS
        , GROUPM_STRUGGLESTREET
        , GROUPM_COUPONCLIPPERS
        , GROUPM_PENNYWISE
        , GROUPM_REALWORKING
        , GROUPM_BUDGETLIVING
    FROM {{ ref('stg_idm__user_profiles') }}
    WHERE (
         GROUPM_BLUECHIP IS NOT NULL OR
         GROUPM_SMARTMONEY IS NOT NULL OR
         GROUPM_FINANCIALFREEDOM IS NOT NULL OR
         GROUPM_SELFMADLIFESTYLERS IS NOT NULL OR
         GROUPM_WORLDLYANDWISE IS NOT NULL OR
         GROUPM_STATUSMATTERS IS NOT NULL OR
         GROUPM_SAVVYSELFSTARTERS IS NOT NULL OR
         GROUPM_HUMANITARIANS IS NOT NULL OR
         GROUPM_FULLHOUSE IS NOT NULL OR
         GROUPM_YOUNGANDPLATINUM IS NOT NULL OR
         GROUPM_HEALTHYWEALTHYANDWISE IS NOT NULL OR
         GROUPM_CULTURALPIONEERS IS NOT NULL OR
         GROUPM_NEWSCHOOLCOOL IS NOT NULL OR
         GROUPM_URBANENTERTAINERS IS NOT NULL OR
         GROUPM_NEWKIWIS IS NOT NULL OR
         GROUPM_SOCIALACADEMICS IS NOT NULL OR
         GROUPM_BIGFUTURE IS NOT NULL OR
         GROUPM_FITANDFAB IS NOT NULL OR
         GROUPM_QUIETACHIEVER IS NOT NULL OR
         GROUPM_CAREERZONE IS NOT NULL OR
         GROUPM_ONTHEIRWAY IS NOT NULL OR
         GROUPM_GETTINGAHEAD IS NOT NULL OR
         GROUPM_DOMESTICJUGGLERS IS NOT NULL OR
         GROUPM_AVERAGEKIWI IS NOT NULL OR
         GROUPM_DOWNTHEARTH IS NOT NULL OR
         GROUPM_DOMESTICBLISS IS NOT NULL OR
         GROUPM_DONEGOOD IS NOT NULL OR
         GROUPM_TRADITIONALVALUES IS NOT NULL OR
         GROUPM_CASTLEANDKIDS IS NOT NULL OR
         GROUPM_HOUSEPROUD IS NOT NULL OR
         GROUPM_FAMILYFIRST IS NOT NULL OR
         GROUPM_RELAXEDLIVING IS NOT NULL OR
         GROUPM_CAUTIOUSCONSERVATIVES IS NOT NULL OR
         GROUPM_MAKINGTHERENT IS NOT NULL OR
         GROUPM_MAKINGENDSMEET IS NOT NULL OR
         GROUPM_DOINGITTOUGH IS NOT NULL OR
         GROUPM_LIFESTRIVERS IS NOT NULL OR
         GROUPM_ACTIVESOCIAL IS NOT NULL OR
         GROUPM_HOMEENTERTAINMENT IS NOT NULL OR
         GROUPM_BETTERDAYS IS NOT NULL OR
         GROUPM_FAITHANDFAMILY IS NOT NULL OR
         GROUPM_SIMPLELIVING IS NOT NULL OR
         GROUPM_QUIETHOMELIFE IS NOT NULL OR
         GROUPM_AREASINTRANSITION IS NOT NULL OR
         GROUPM_STILLWORKING IS NOT NULL OR
         GROUPM_NEWBEGINNINGS IS NOT NULL OR
         GROUPM_STRUGGLESTREET IS NOT NULL OR
         GROUPM_COUPONCLIPPERS IS NOT NULL OR
         GROUPM_PENNYWISE IS NOT NULL OR
         GROUPM_REALWORKING IS NOT NULL OR
         GROUPM_BUDGETLIVING IS NOT NULL)

)

SELECT
    *
FROM account_management__user_profiles
