{{
  config(
        tags=['adw']
    )
}}

WITH satdata AS (

    SELECT

        AD_REPORT_KEY
        , AD_REPORT_HASH
        , RECORD_SOURCE
        , CAST(NULL AS STRING) AS CAMPAIGN_ID
        , CAST(NULL AS STRING) AS LINE_ID
        , CAST(NULL AS STRING) AS MONTH_UNIQUE_ID
        , DATE AS DATE
        , CAST(NULL AS DATE) AS DATE_ENTERED
        , 'Digital' AS ORIGIN
        , 'Showcase_plus' AS SOURCE
        , '(not set)' AS PRIMARY_REP_GROUP
        , 'Showcase Plus' AS SOURCE_OR_GL

        , CAST(NULL AS STRING) AS AGENCY_LEGACYs

        , CAST(NULL AS STRING) AS ADVERTISER_ID

        , CAST(NULL AS STRING) AS ADVERTISER_LEGACY

        , CAST(NULL AS STRING) AS CUSTOMERNUMBER

        , AD_ADVERTISER_NAME AS ADVERTISER_NAME
        {# , AD_ADVERTISER_NAME AS CUSTOMERNAME #}
        , 'Other Services' AS PIB_CATEGORY_DESC
        , CAST(NULL AS STRING) AS AGENCY_NAME
        , CAST(NULL AS STRING) AS PRODUCT_NAME
        , CAST(AD_PRODUCT_ID AS STRING) AS PRODUCT_ID
        , CAST(NULL AS STRING) AS SIZE_DESC
        {# , AD_AD_UNIT AS SIZE #}
        , CAST(NULL AS STRING) AS AD_TYPE_ID
        , NULL AS GROSS_LINE_LOCAL_AMOUNT
        , SAFE_CAST(REGEXP_REPLACE(AD_REVENUE, '[^0-9.]', '') AS FLOAT64) AS REVENUE
        , CAST(NULL AS STRING) AS FILEUPDATEDATETIME

        , 'NBLY' AS GL_TYPE_ID

        , 'Neighbourly' AS GL_TYPES_DESCRIPTION

		{# , CASE WHEN AD_PROPERTY like '%Showcase%' then 'Neighbourly'
		WHEN AD_PROPERTY like '%TURBO%' then 'TurboSEO'
		ELSE 'Unknown' END as TYPE #}

        , 'Paid Advertising (excl House and Contra)' AS PAID_ADVERTISING

        , AD_CURRENT_REP_NAME AS CURRENT_REP_NAME

        , 'Showcase Plus' AS PLATFORM

        , 'Showcase Plus' AS PRODUCT_TYPE

        , CAST(NULL AS STRING) AS PRIMARY_GROUP_ID
        , CAST(NULL AS STRING) AS CLIENT_TYPE_ID
        , CAST(NULL AS STRING) AS CAMPAIGN_TYPE
        , CAST(NULL AS STRING) AS CAMPAIGN_STATUS_CODE
        , CAST(NULL AS STRING) AS LINE_CANCEL_STATUS_ID
        , CAST(NULL AS STRING) AS CURRENCY_EXCHANGE_RATE
        , CAST(NULL AS STRING) AS CURRENCY_CODE
        , NULL AS AGENCY_COMMISSION_PERCENT
        , CAST(NULL AS STRING) AS NO_AGY_COMM_IND
        , NULL AS ACTUAL_LINE_LOCAL_AMOUNT
        , NULL AS EST_LINE_LOCAL_AMOUNT
        , NULL AS GROSS_LINE_FOREIGN_AMOUNT
        , NULL AS NET_LINE_FOREIGN_AMOUNT
        , CAST(NULL AS STRING) AS CURRENT_REP_ID
        , CAST(NULL AS STRING) AS CURRENT_REP_PCT
        , CAST(NULL AS STRING) AS NET_REP_AMOUNT
        , CAST(NULL AS STRING) AS MONTH_ACTUAL_AMT
        , CAST(NULL AS STRING) AS MONTH_EST_AMT
        , CAST(NULL AS STRING) AS PRODUCT_GROUPING
        , CAST(NULL AS STRING) AS PRIMARY_REP_GROUP_ID
        , CAST(NULL AS STRING) AS AGENCY_ID
        , CAST(NULL AS STRING) AS AD_INTERNET_CAMPAIGNS_BRAND_ID
        , CAST(NULL AS STRING) AS BRAND_PIB_CODE
        , CAST(NULL AS STRING) AS SECTION
        , CAST(NULL AS STRING) AS EST_QTY
        , CAST(NULL AS STRING) AS MONTH_ACTUAL_IMPS
    {# , NULL AS PUBLISHEDCLASSIFICATION #}

    FROM {{ ref('sat_ad_revenue_showcase_plus') }}

)

SELECT * FROM satdata
